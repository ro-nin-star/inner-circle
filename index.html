<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="title">Perfect Circle - Rajzolj TÃ¶kÃ©letes KÃ¶rt!</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <!-- DekoratÃ­v kÃ¶rÃ¶k -->
    <div class="decoration-circle"></div>
    <div class="decoration-circle"></div>
    <div class="decoration-circle"></div>

    <!-- ===== EZ A FELSÅ FIX FEJLÃ‰C, AMI MINDENT TARTALMAZ ===== -->
    <div class="top-fixed-header">
        <!-- Firebase Status - Ide kell Ã¡thelyezni az eredeti firebase-status-t, Ã©s csak EZ marad! -->
        <div class="firebase-status connecting" id="firebaseStatus" onclick="showFirebaseInfo()" data-i18n="firebase.connecting">ğŸŸ¡ KapcsolÃ³dÃ¡s...</div>

        <!-- Nyelv vÃ¡ltÃ³ - Ide kell Ã¡thelyezni az eredeti language-selector-t, Ã©s csak EZ marad! -->
        <div class="language-selector" id="languageSelector">
            <div class="current-language" onclick="window.i18nManager?.toggleLanguageMenu()">
                <span id="currentLanguageFlag">ğŸ‡­ğŸ‡º</span>
                <span id="currentLanguageCode">HU</span>
            </div>
            <div class="language-menu" id="languageMenu">
                <!-- Dinamikusan tÃ¶ltÅ‘dik a JavaScript Ã¡ltal -->
                <!-- PÃ©lda egy opciÃ³ra, amit a JS generÃ¡lhat: -->
                <!-- <div class="language-option" data-lang="hu">Magyar</div> -->
                <!-- <div class="language-option" data-lang="en">English</div> -->
            </div>
        </div>
    </div>
    <!-- ==================================================== -->

    <div class="game-container" id="gameContainer">
        <h1 data-i18n="title">ğŸ¯ Perfect Circle</h1>
        <p class="subtitle" data-i18n="subtitle">Rajzolj a lehetÅ‘ legtÃ¶kÃ©letesebb kÃ¶rt egyetlen mozdulattal!</p>
        
        
        <div class="instructions">
            <strong data-i18n="instructions.title">Hogyan jÃ¡tssz:</strong> 
            <span data-i18n="instructions.text">Kattints Ã©s hÃºzd az egeret (vagy Ã©rintsd Ã©s hÃºzd az ujjad) hogy egy kÃ¶rt rajzolj. MinÃ©l tÃ¶kÃ©letesebb a kÃ¶rÃ¶d, annÃ¡l tÃ¶bb pontot kapsz! A kÃ¶r varÃ¡zslatos mÃ³don Ã¡t fog vÃ¡ltozni! âœ¨</span>
        </div>

        <!-- Offline notice -->
        <div class="offline-notice" id="offlineNotice">
            <span data-i18n="firebase.offlineNotice">âš ï¸ <strong>Offline mÃ³d:</strong> A globÃ¡lis ranglista nem elÃ©rhetÅ‘. Az eredmÃ©nyek helyben mentÅ‘dnek.</span>
        </div>

        <!-- PLAYER NAME SECTION -->
        <div class="player-name-section">
            <label for="playerName"><strong data-i18n="player.label">ğŸ‘¤ JÃ¡tÃ©kos nÃ©v:</strong></label>
            <input type="text" id="playerName" class="player-name-input" data-i18n="player.placeholder" placeholder="Add meg a neved" maxlength="20" value="">
            <button onclick="savePlayerName()" style="padding: 8px 16px; font-size: 12px;" data-i18n="buttons.save">ğŸ’¾ MentÃ©s</button>
        </div>

        <div class="difficulty-selector">
            <strong data-i18n="difficulty.label">NehÃ©zsÃ©g:</strong>
            <button class="difficulty-btn active" onclick="setDifficulty('easy')" data-difficulty="easy" data-i18n="difficulty.easy">KÃ¶nnyÅ± ğŸ˜Š</button>
            <button class="difficulty-btn" onclick="setDifficulty('hard')" data-difficulty="hard" data-i18n="difficulty.hard">NehÃ©z ğŸŒ€</button>
        </div>

        <div class="game-stats" id="gameStats">
            <div class="stat" id="currentScoreStat">
                <div class="stat-label" data-i18n="stats.currentScore">Jelenlegi PontszÃ¡m</div>
                <div class="stat-value" id="currentScore">0</div>
            </div>
            <div class="stat" id="bestScoreStat">
                <div class="stat-label" data-i18n="stats.bestScore">Legjobb EredmÃ©ny</div>
                <div class="stat-value" id="bestScore">0</div>
            </div>
            <div class="stat" id="gamesPlayedStat">
                <div class="stat-label" data-i18n="stats.gamesPlayed">JÃ¡tÃ©kok SzÃ¡ma</div>
                <div class="stat-value" id="gamesPlayed">0</div>
            </div>
            <div class="stat" id="averageScoreStat">
                <div class="stat-label" data-i18n="stats.averageScore">Ãtlag PontszÃ¡m</div>
                <div class="stat-value" id="averageScore">0</div>
            </div>
        </div>

        <!-- Canvas container - JAVÃTOTT -->
        <div class="canvas-container">
            <canvas id="gameCanvas" width="400" height="400"></canvas>
            <canvas id="idealCircleCanvas" width="400" height="400"></canvas>
            <div class="canvas-overlay" id="canvasOverlay"></div>
            <div class="transformation-overlay" id="transformationOverlay">
                <div class="transformation-content">
                    <h2 id="transformationText" data-i18n="transformation.magic">âœ¨ VarÃ¡zslat tÃ¶rtÃ©nik... âœ¨</h2>
                </div>
            </div>
        </div>

        <div class="controls">
            <button id="startBtn" onclick="startDrawing()" data-i18n="buttons.startDrawing">ğŸ¯ RajzolÃ¡s KezdÃ©se</button>
            <button id="clearBtn" onclick="clearCanvas()" disabled data-i18n="buttons.clear">ğŸ—‘ï¸ TÃ¶rlÃ©s</button>
            <button onclick="showInstructions()" data-i18n="buttons.help">â“ SegÃ­tsÃ©g</button>
            <button onclick="clearAllScores()" data-i18n="buttons.clearScores">ğŸ—‘ï¸ Helyi EredmÃ©nyek TÃ¶rlÃ©se</button>
            <!-- Dinamikusan hozzÃ¡adott gombok: Audio, TÃ©ma, Fejlett, Nyelv info -->
        </div>

        <!-- PontszÃ¡m megjelenÃ­tÅ‘ -->
        <div class="score-display" id="scoreDisplay">
            <h3 id="scoreTitle" data-i18n="scoreTitle.result">EredmÃ©ny</h3>
            <div class="score-number">
                <span id="finalScore">0</span>/100 <span data-i18n="common.points">pont</span>
            </div>
            <div class="score-breakdown" id="scoreBreakdown">
                <!-- Dinamikusan tÃ¶ltÅ‘dik -->
            </div>
            
            <!-- IdeÃ¡lis kÃ¶r Ã¶sszehasonlÃ­tÃ¡s - JAVÃTOTT -->
            <div id="idealCircleContainer" class="ideal-circle-container" style="display: none;">
                <h4 data-i18n="analysis.idealCircle">IdeÃ¡lis kÃ¶r Ã¶sszehasonlÃ­tÃ¡s:</h4>
                <div class="ideal-circle-canvas-container">
                    <canvas id="idealComparisonCanvas" width="200" height="200"></canvas>
                </div>
            </div>
        </div>

        <!-- LEADERBOARD WITH TABS -->
        <div class="leaderboard">
            <h3 data-i18n="leaderboard.title">ğŸ† Ranglista</h3>
<div class="leaderboard-tabs">
    <button class="tab-btn active" id="localTab" data-i18n="leaderboard.local">ğŸ“± Helyi</button>
    <button class="tab-btn" id="globalTab" data-i18n="leaderboard.global">ğŸŒ GlobÃ¡lis</button>
</div>

            <div class="leaderboard-status" id="leaderboardStatus" data-i18n="leaderboard.localResults">
                ğŸ“± Helyi eredmÃ©nyek
            </div>
            <div id="leaderboardList">
                <div class="score-entry">
                    <span data-i18n="leaderboard.noResults">MÃ©g nincsenek eredmÃ©nyek</span>
                </div>
            </div>
            
            <!-- Leaderboard export/import gombok -->
            <div class="leaderboard-actions">
                <button onclick="window.LeaderboardManager?.exportLeaderboard()" data-i18n="leaderboard.export">ğŸ“¤ Export</button>
                <button onclick="window.LeaderboardManager?.importLeaderboard()" data-i18n="leaderboard.import">ğŸ“¥ Import</button>
            </div>
        </div>

        <!-- RÃ©szletes instrukciÃ³k -->
        <div class="detailed-instructions">
            <h3 data-i18n="instructions.detailedTitle">ğŸ“– RÃ©szletes ÃštmutatÃ³</h3>
            <div class="instruction-section">
                <h4 data-i18n="instructions.gameplayTitle">ğŸ® JÃ¡tÃ©kmenet:</h4>
                <ul>
                    <li data-i18n="instructions.step1">Kattints a "RajzolÃ¡s KezdÃ©se" gombra</li>
                    <li data-i18n="instructions.step2">Rajzolj egy kÃ¶rt egyetlen mozdulattal</li>
                    <li data-i18n="instructions.step3">NÃ©zd meg az eredmÃ©nyed Ã©s a transzformÃ¡ciÃ³t!</li>
                </ul>
            </div>
            
            <div class="instruction-section">
                <h4 data-i18n="instructions.scoringTitle">ğŸ“Š PontszÃ¡mÃ­tÃ¡s:</h4>
                <ul>
                    <li data-i18n="instructions.shapeScore">ğŸ”µ KÃ¶ralak (40 pont): Mennyire hasonlÃ­t kÃ¶rre</li>
                    <li data-i18n="instructions.closureScore">ğŸ”— ZÃ¡rÃ³dÃ¡s (20 pont): Mennyire zÃ¡rt a forma</li>
                    <li data-i18n="instructions.smoothnessScore">ğŸŒŠ EgyenletessÃ©g (25 pont): Mennyire egyenletes a vonal</li>
                    <li data-i18n="instructions.sizeScore">ğŸ“ MÃ©ret (15 pont): OptimÃ¡lis mÃ©ret hasznÃ¡lata</li>
                </ul>
            </div>
            
            <div class="instruction-section">
                <h4 data-i18n="instructions.transformationsTitle">ğŸ¨ TranszformÃ¡ciÃ³k:</h4>
                <p data-i18n="instructions.transformationsText">70+ pont esetÃ©n a kÃ¶rÃ¶d varÃ¡zslatos alakzattÃ¡ vÃ¡ltozik! Minden transzformÃ¡ciÃ³ utÃ¡n egy mosolygÃ³ arc jelenik meg! ğŸ˜Š</p>
            </div>
            
            <div class="instruction-section">
                <h4 data-i18n="instructions.controlsTitle">âŒ¨ï¸ BillentyÅ± parancsok:</h4>
                <ul>
                    <li data-i18n="instructions.ctrlS">Ctrl+S: RajzolÃ¡s kezdÃ©se</li>
                    <li data-i18n="instructions.ctrlR">Ctrl+R: TÃ¶rlÃ©s</li>
                    <li data-i18n="instructions.ctrlH">Ctrl+H: SegÃ­tsÃ©g</li>
                    <li data-i18n="instructions.ctrlL">Ctrl+L: Nyelv menÃ¼</li>
                    <li data-i18n="instructions.escape">Esc: JÃ¡tÃ©k megszakÃ­tÃ¡sa</li>
                    <li data-i18n="instructions.f1">F1: SegÃ­tsÃ©g</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- LÃ¡togatÃ¡sszÃ¡mlÃ¡lÃ³ -->
    <div class="visitor-counter" id="visitorCounter" onclick="showVisitStats()">
        <span data-i18n="visitors.label">LÃ¡togatÃ¡sok:</span> <span class="visitor-number" id="visitCount">0</span>
    </div>

    <!-- FejlesztÅ‘i informÃ¡ciÃ³k -->
    <div class="dev-info">
        <span data-i18n="dev.version">v2.0</span> | 
        <span onclick="window.debugGameEngine?.()" data-i18n="dev.debug">Debug</span>
    </div>

    <!-- JavaScript fÃ¡jlok betÃ¶ltÃ©se -->
    <script>
        // GlobÃ¡lis nyelvi adatok tÃ¡rolÃ³ja
        window.languageData = {};
        
        // Magyar nyelv beÃ¡gyazÃ¡sa
        window.languageData.hu = {
            // ... (az elÅ‘zÅ‘ teljes magyar fordÃ­tÃ¡s)
        };
    </script>

    <script src="js/i18n/languageDetector.js"></script>
    <script src="js/i18n/i18nManager.js"></script>
    
    <!-- Firebase Scripts -->
    <script src="js/firebase/firebase-config.js" type="module"></script>
    
    <!-- Utility Scripts -->
    <script src="js/utils/audioManager.js"></script>
    <script src="js/utils/effectsManager.js"></script>
    
    <!-- Game Scripts -->
    <script src="js/game/transformations.js"></script>
    <script src="js/game/circleAnalyzer.js"></script>
    <script src="js/game/gameEngine.js"></script>
    
    <!-- Manager Scripts -->
    <script src="js/managers/scoreManager.js"></script>
    <script src="js/managers/visitorCounter.js"></script>
    <script src="js/managers/leaderboardManager.js"></script>
    
    <!-- Main App Script UTOLJÃRA -->
    <script src="js/app.js"></script>

    <!-- InicializÃ¡lÃ¡s -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸŒ DOM betÃ¶ltve, i18n inicializÃ¡lÃ¡s...');
            
            if (window.languageData && window.languageData.hu) {
                window.simpleTranslate = function(key, params = {}) {
                    const keys = key.split('.');
                    let value = window.languageData.hu;
                    
                    for (const k of keys) {
                        if (value && typeof value === 'object' && value[k] !== undefined) {
                            value = value[k];
                        } else {
                            return key;
                        }
                    }
                    
                    if (typeof value === 'string' && params) {
                        Object.keys(params).forEach(param => {
                            value = value.replace(`{${param}}`, params[param]);
                        });
                    }
                    
                    return value;
                };
                
                document.querySelectorAll('[data-i18n]').forEach(element => {
                    const key = element.getAttribute('data-i18n');
                    const translation = window.simpleTranslate(key);
                    
                    if (translation && translation !== key) {
                        if (element.tagName === 'INPUT' && element.type === 'text') {
                            element.placeholder = translation;
                        } else {
                            element.innerHTML = translation;
                        }
                    }
                });
                
                console.log('âœ… EgyszerÅ±sÃ­tett i18n inicializÃ¡lva');
            }
        });
    </script>
</body>
</html>
